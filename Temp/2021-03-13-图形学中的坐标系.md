

##  3D坐标

**3D坐标系总共有48种，可分为两类（左手系和右手系）每类24种。**

**同样仅在3维空间中旋转，无法重合两个不同类别的坐标系（你无法旋转你的手机得到一个镜子里的手机）。旋转中你会发现最接近的情况下有一个轴正好是反向的，如果你不改变两个轴向，反转另一个轴向，那么坐标轴就会发生类别的转换**

**这个反转轴向改变坐标轴类别的过程，其实就是在4维空间中旋转3维空间，这个旋转在3维空间中的投影就被表现为一个轴向从1伸缩变换维为-1，而另两个轴向不变**

**------1.4.2 左手系和右手系**

**食指指向你的上方，中指指你的向前方，拇指指向另一只手的方向。你的左右手将分别构建两个坐标系（左手系和右手系）**

**区分方法，站在x轴正方向看向原点。左手系中顺时针旋转是y+转向z+，右手系中则是y+转向z-**

**本书及以下笔记采用标准左手系，大部分公式，定理无所谓坐标系类别都可成立，坐标系不同情况书中以及以下笔记将有特别提醒和记录**

**------1.4.3 类比2D坐标系和3D坐标系**

**同样的（x，y，z）表示3D坐标系中的具体位置，xyz 大小代表距离，正负代表方向。xyz值是在其轴上的分量，也是到处此轴外另两轴构成平面的距离**



## 多坐标系



**--2.1 为什么引入多坐标系的概念**

请描述一整天你的手机相对于你的位置，或许它现在就被拿在你手里，之前被放在口袋里...不过相对于你的位置你手机在一天中的位置还是很好追踪的

那么请描述一整天你的手机相对于地球的位置（用经纬度加离地表面高度）

好吧这么做就算你有能测量经纬度和离地高度的仪器你也快要疯了，因为首先你要思考下这一天你都去了哪里，再叠加上手机都被放或是拿在哪里...

有时候在一个坐标系中一个很好描述的物体，但到别的坐标系内位置就变得不好描述了

或是在建立连接两个城市的公路，公路的设计图（一个新的坐标系）上一边是A城一边是B城，参照原本A B城靠公路一侧郊区的位置需要被转换到公路的设计图上

**---2.2 3D游戏开发中一些有用的坐标系**

**------2.2.1 世界坐标系**

**世界坐标也被称之为绝对坐标，这个“绝对”指在这个世界之中**

**一个坐标系只能描述其内部的物体，而对于这个坐标系本身的位置描述或是坐标系之外物体的位置描述就需要寻找或建立新的坐标系（你可以用经纬度描述你在地球上的位置，但我问你地球在哪时，你会如何描述？）**

3D游戏中的“世界”，就是这个游戏所需要展示的全部，不一定是和类比我们真实世界一样的世界

**世界坐标系中的问题：物体的位置方位，物体的来去追踪，任意一点的地形**

**------2.2.2 物体坐标系**

每一个物体都带有自己的坐标。向前走，你一定知道要往哪里走，但相对于世界坐标可能有的人向西走，有的人向东走

物体位置改变时，物体坐标系和与之相关连的坐标系一同改变（unity中移动物体，物体和该物体的子物体一起移动）

3D游戏物体坐标的建立，由美术在建立模型时确定，可参考文章《当3dMax遇上unity3d》中模型轴向的设置建议

**物体坐标系中的问题：其他物体相对物体的位置，接下来的行动应相对于此时物体的那个方向**

**------2.2.3 摄像机坐标系**

摄像机也是一个物体也有它的物体坐标，在此基础上一般规定Z+方向为摄像机看向的方向（unity中采用此规定）

广角摄像机完成了一个根据看向方向，广角度数形成的一个椎体内的物体投影到观察屏幕上的功能

**摄像机坐标系中的问题：给定点是否在摄像机前方，是否进入观察投影椎体，是否被其他物体遮挡（可见性检测，深度问题）**

**------2.2.4 惯性坐标系**

**惯性坐标系是于物体同一位置，但轴向平行于世界坐标的坐标系**

**惯性坐标系的存在是作为中介，简化世界坐标变换到物体坐标的过程（仅平移即可完成世界坐标与惯性坐标的转换，仅旋转即可完成惯性坐标与物体坐标的转换）**

**---2.3 嵌套坐标系**

在3D游戏中以世界坐标系为最高“父”空间，世界中的物体所具有的物体坐标，以及物体的子物体的物体坐标，和在“父”物体中的坐标。每个物体既有在世界坐标中的绝对位置，也有在相对于上一级“父”空间的相对位置。从而形成坐标系的嵌套

上文中已提到过有时在一个坐标系中一个很好描述的物体，但到别的坐标系内位置就变得不好描述了。因此需要引入多坐标系，并形成坐标系嵌套关系。**根据坐标系的嵌套关系，以及物体在不同坐标系中的位置，找到描述物体位置的合适“路径”**

**3D游戏中嵌套坐标系在数据结构中形成以世界坐标为根，子层级坐标系为枝叶的嵌套式坐标系树。嵌套式坐标系树能在虚拟世界的生命周期内动态更新，以表现物体的层级转换，子物体从父物体上脱落成武世界坐标系中的物体，亦或是世界坐标系中的莫物体被另一物体捕获，成为该物体的子对象**

**---2.4 描述坐标系**

由于已经提到过，位置的描述需要在能够包含该位置的更高级的坐标系内

坐标系的位置描述需要描述其在父坐标系中其原点的位置，以及轴的指向

世界坐标的位置描述在3D游戏中是没有意义的

**---2.5 坐标系转换**

通过惯性系为桥梁，完成世界坐标系和物体坐标系的相互转换

将物体坐标通过变换到和世界坐标重合，其所需的步骤与世界坐标变换到物体的步骤正好在顺序和数值上均相反

**在寻找物体坐标系内某一点在世界坐标系中的位置时**







## 坐标系之前转换







