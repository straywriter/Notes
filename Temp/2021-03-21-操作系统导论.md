



计算机系统



操作系统定义



操作系统的发展历程









## 导论 

## 计算机系统



**计算机系统组成部分：**

- 计算机硬件
- 操作系统
- 系统程序与应用程序
- 用户



> 1.计算机系统主要由四个基础部分组成：处理器、存储器、输入输出（IO）模块和系统总线。
>
> 处理器：控制计算机的操作，执行数据的处理，通常指CPU。在处理中含有寄存器，寄存器相对内存来说容量很小，但存取速度相当快，可以用来暂存指令和数据等。寄存器有多种不同的分类。如地址寄存器和指令寄存器等。地址寄存器存放下一步需要从存储器中读取的存储器地址，指令寄存器存取当前正在执行的程序指令。
>
> 存储器：分为内存和外存。主要用于存储数据和程序，通常都是易失的（计算机关机后数据丢失），因此也是数据临时性的存放场所。
>
> 输入输出模块：在计算机和外部环境之间移动数据，外部环境包括各种设备（如硬盘、磁盘和各种终端等）。输入模块是把人们所熟悉的某种信息形式变换为及其内部所能接收和识别的二进制信息形式。输出设备把计算机处理结果变化为人和其他机器设备所能接收和识别的信息形式。注意：IO模块也可以直接和处理器交换数据。也可以直接与内存交换数据，此时，IO模块对存储器发出读命令或写命令，从而免去了处理器负责数据交换的任务。这种操作叫做直接内存存储（DMA）。
>
> 系统总线：是计算机系统各部件之间进行数据传送的公共通路。
>
> 2.指令的执行
>
> 在不考虑中断的情况下，指令的执行包括两个阶段：处理器从存储器中取指令阶段和处理器执行指令阶段。去取指令阶段和执行指令阶段构成一个指令周期。寄存器中的程序计算器保存下一次要取的指令地址，每次取到的指令放在指令寄存器，处理器解释指令并执行对应的操作。
>
> 中断：中断是处理器中断当前正在执行的程序指令，是其他模块（IO模块、存储器）中断处理器正常处理过程的机制。主要目的是提高处理器的效率。原因是因为其他模块在执行过程中比处理器慢很多，导致在处理器在执行过程中如果遇到与其他的模块进行交互（因为其他模块可能需要进行自己的特有某些操作，如打印机打印操作过程中，此时是不需要处理器在一直处理等待状态的...），有很长时间实际上是处于等待状态而未得到充分利用。
>
> 中断请求：是其他模块向处理器发送的用于希望处理器中断当前处理器正在执行的指令，转而执行此外部模块的中断程序，并且处理器负责将正在执行的程序挂起。当中断处理完成后，处理器恢复执行。
>
> 考虑到中断阶段，指令的执行周期变为了取指令阶段、执行阶段和中断阶段。
>
> 3. 中断处理流程：
>
> 其他模块设别控制器或其他系统硬件产生一个中断信号给处理器 >> 处理器结束当前指令的执行 >> 处理器发送中断应答信号 >> 处理器将程序状态字和程序计数器压入控制栈 >> 根据中断，处理器加载新的程序计数器 >> 保存剩余的处理状态信息 >> 处理器处理中断程序 >> 中断处理完成后，处理器恢复处理状态信息 >> 处理器恢复老的程序状态字和程序计算器 >> 处理器继续执行原来的程序指令
>
> 4. 存储器的存储结构
>
> 存储器的设计主要要在三个方面做出协调：容量、速度和价格。存储器的层次结构是依据局部性原理：处理器访问存储器时，无论是存取指令还是存取数据，所访问的存储单元都趋于聚集在一个较小的连续单元中。也就是说位于被访问字附件的数据在近期被访问到的概率比较大。局部性又包括三种不同的类型：时间局部性——如果一个信息项正在被访问，那么在近期它很可能还会被再次访问。空间局部性——在最近和将来用到的信息很可能与现在使用的信息在空间商地址上是临近的。顺序局部性——在典型程序中，除转移类指令外，大部分指令是顺序执行的。
>
> 典型的存储器的层次结构如下图：
>
> ![img](https://pic002.cnblogs.com/images/2012/426802/2012112715205764.png)
>
>  二级存储器：与一级存储器相对，二级存储器是外部的非易失性，外部的或可移动的。二级存储设备容量上更大，读取更慢但相对更便宜。
>
> 高速缓存：介于处理器和内存中间的高速小容量的存储器，和内存一起构成一级存储器。高速缓存存储器和内存之间的信息调度和传送是由硬件自动进行的。高速缓存有时也分为一级高速缓存、二级高速缓存...每级高速缓存都比前一级存取速度慢但容量大。高速缓存是为了解决处理器处理速度远快于内存的速度而出现的，其基本原理还是局部性原理。高速缓存包含一部分内存数据的副本，此后处理器读取数据时，首先从高速缓存中判断是否存在，若有则直接从高速缓存中传送过去，若没有则从内存中以一定长度的块数据先读入高速缓存，然后再从高速缓存中传到处理器。









计算机系统的存储结构：







计算机系统的I/O结构：







### 计算机系统体系结构

- 单处理器系统

  - 只有一个通用 CPU
  - 还包含其他特定目的微处理器， 用来克服主 CPU 超载问题

- 多处理器系统(并行系统 Parallel system, 紧耦合系统 tightly coupled system)

  - 拥有多个紧密通信的 CPU，共享计算机总线，时钟，内存和外设

  优点：

  - 增加吞吐量
  - 规模经济
  - 增加可靠性

计算机系统不断增加的可靠性是很关键的，这种能提供与正常工作的硬件成正比的服务的能力称为**适度退化**(graceful degradation)。超出适度退化的能力被称为容错(fault tolerant)

多处理器系统主要分为

非对称多处理(asymmetric multiprocessing) ： 主从处理器

对称多处理(symmetric multiprocessing， SMP)

概念： 刀片服务器(blade server) 每个刀片处理器独立启动并运行各自的系统

- 集群系统：

由两个或多个独立的系统耦合起来的

通过局域网连接或更快的内部连接(InfiniBand)

用途： 提供高可用性(high availability)服务

分类：对称与非对称

非对称集群(asymmetric clustering)中， 一台机器处于热备份状态(hot standby mode)，另一台运行程序。

对称集群(symmetric clustering)，两个或多个主机都运行程序并互相监视。

还有并行集群和 WAN 集群。

并行集群中通常需要分布式锁管理器(distributed lock manager， DLM)





## 操作系统

**操作系统的定义：**

操作系统(Operating System, OS)：是指控制和管理整个计算机系统的硬件和软件资源，并合理地组织调度计算机的工作和资源分配，以提供给用户和其他软件方便的接口和环境的软件集合。



**操作系统的四个特征：并发、共享、虚拟、异步**

1. 并发性(Concurrence)：并发是指两个或多个时间在同一时间间隔内发生。操作系统的并发性是指操作系统中同时存在多个运行着的程序。引入进程的目的是使程序能够并发执行。并发和共享是操作系统最基本的两个特征。
   并发（同一时间间隔），并行（同一时刻）。并发是指一段时间内，宏观上有多道程序在同时执行。并行是指在每一时刻，单处理器的环境下实际仅能有一道程序执行。并行性需要硬件的条件支撑，例如：多流程或是多处理器
2. 共享(Sharing)：资源共享即共享，是指系统中的资源可供内存中的多个并发执行的进程共同使用，可以分为两种资源共享方式：
   1：互斥共享方式：一段时间内仅允许一个进程访问该资源，这样的资源被称为临界资源或是独占资源，例如打印机等等
   2：同时访问方式：一段时间内允许多个进程访问该资源，只是一个请求分几个时间片间隔完成的效果和连续完成的效果相同，例如磁盘设备等等
3. 虚拟(Virtual)：指把一个物理上的实体变为若干个逻辑上的对应物，有时分复用技术：处理器的分时共享，空分复用技术：虚拟存储器
4. 异步(Asynchronism)：在多道程序环境下，允许多个程序并发执行，但是由于资源有限，进程的执行不一定是连贯到底，而是走走停停。



### 操作系统的发展历程

- 手工操作





### 操作系统分类

- 大型机操作系统
- 服务器操作系统
- 多处理器操作系统
- 个人计算机操作系统
- 掌上计算机操作系统
- 嵌入式操作系统
- 传感器节点操作系统
- 实时操作系统
- 智能卡操作系统





## 操作系统结构

整体式结构

模块化结构

层次结构

微内核结构

https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84/20925176



> 操作系统 的
>
> 
>
> **大内核：**
>
> 如果内核不仅包括了时钟管理、中断处理以及原语（设备驱动、CPU 切换），还包含了进程管理、存储器管理以及设备管理等功能，那么就属于**大内核**。
>
> 大内核虽然使得内部代码非常庞大复杂，但是在用户态与核心态之间的切换，相对来说是很快的，这是因为大内核集成了进程管理、存储器管理等；
>
> **微内核：**
>
> 如果内核仅由时钟管理、中断处理以及原语（设备驱动、CPU 切换）构成，那么这种内核属于**微内核**；
>
> 微内核的代码结构相对来说就很清晰、便于维护，但是由于微内核只集成了时钟管理、中断处理等这些最最基本的功能，所以在涉及到进程管理、存储器管理等时，就可能需要频繁变态（切换到用户态），而变态是需要消耗时间的，这无疑就会降低运行的性能。



## 操作系统的基本功能



> ### 1. 进程管理
>
> 进程控制、进程同步、进程通信、死锁处理、处理机调度等。
>
> ### 2. 内存管理
>
> 内存分配、地址映射、内存保护与共享、虚拟内存等。
>
> ### 3. 文件管理
>
> 文件存储空间的管理、目录管理、文件读写管理和保护等。
>
> ### 4. 设备管理
>
> 完成用户的 I/O 请求，方便用户使用各种设备，并提高设备的利用率。
>
> 主要包括缓冲管理、设备分配、设备处理、虛拟设备等。



> 为了给多道程序提供良好的运行环境，操作系统应具有以下几方面的功能：处理机管理、 存储器管理、设备管理和文件管理。为了方便用户使用操作系统，还必须向用户提供接口。同时操作系统可用来扩充机器，以提供更方便的服务、更高的资源利用率。
>
> ## 操作系统作为计算机系统资源的管理者
>
> #### 1) 处理机管理
>
> 在多道程序环境下，处理机的分配和运行都以进程（或线程）为基本单位，因而对处理机的管理可归结为对进程的管理。并发时在计算机内同时运行多个进程，所以，进程何时创建、何时撤销、如何管理、如何避免冲突、.合理共享就是进程管理的最主要的任务。进程管理的主要功能有：进程控制、进程同步、进程通信、死锁处理、处理机调度等。
>
> #### 2) 存储器管理
>
> 存储器管理是为了给多道程序的运行提供良好的环境，方便用户使用以及提高内存的利用率，主要包括内存分配、地址映射、内存保护与共享和内存扩充等功能。
>
> #### 3) 文件管理
>
> 计算机中的信息都是以文件的形式存在的，操作系统中负责文件管理的部分称为文件系统。文件管理包括文件存储空间的管理、目录管理及文件读写管理和保护等。
>
> #### 4) 设备管理
>
> 设备管理的主要任务是完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率，主要包括缓冲管理、设备分配、设备处理和虛拟设备等功能。

## 操作系统的运行环境



操作系统的运行机制



中断和异常



系统调用





## 相关参考

[百度百科 操作系统史](https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8F%91%E5%B1%95%E5%8F%B2)

[wiki 操作系统历史](https://zh.wikipedia.org/zh-hans/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%86%E5%8F%B2)



文章

[Operating Systems: Three Easy Pieces](https://pages.cs.wisc.edu/~remzi/OSTEP/)

[两万字笔记快速看完《操作系统导论（Operating Systems: Three Easy Pieces）》](https://blog.csdn.net/O_1CxH/article/details/111712808)